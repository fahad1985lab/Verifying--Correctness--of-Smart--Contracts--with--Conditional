<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>basicBitcoinDataType</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="basicBitcoinDataType.html" class="Module">basicBitcoinDataType</a> <a id="29" class="Keyword">where</a>



<a id="38" class="Keyword">open</a> <a id="43" class="Keyword">import</a> <a id="50" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="60" class="Keyword">hiding</a> <a id="67" class="Symbol">(</a><a id="68" href="Data.Nat.Base.html#1691" class="Datatype Operator">_≤_</a><a id="71" class="Symbol">)</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Data.List.html" class="Module">Data.List</a> <a id="95" class="Keyword">hiding</a> <a id="102" class="Symbol">(</a><a id="103" href="Data.List.Base.html#1954" class="Function Operator">_++_</a><a id="107" class="Symbol">)</a>
<a id="109" class="Keyword">open</a> <a id="114" class="Keyword">import</a> <a id="121" href="Data.Unit.html" class="Module">Data.Unit</a>  
<a id="133" class="Keyword">open</a> <a id="138" class="Keyword">import</a> <a id="145" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="156" class="Keyword">open</a> <a id="161" class="Keyword">import</a> <a id="168" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="179" class="Keyword">hiding</a> <a id="186" class="Symbol">(</a><a id="187" href="Data.Bool.Base.html#681" class="Datatype Operator">_≤_</a> <a id="191" class="Symbol">;</a> <a id="193" href="Data.Bool.Base.html#1505" class="Function Operator">if_then_else_</a> <a id="207" class="Symbol">)</a> <a id="209" class="Keyword">renaming</a> <a id="218" class="Symbol">(</a><a id="219" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a> <a id="223" class="Symbol">to</a> <a id="226" class="Function Operator">_∧b_</a> <a id="231" class="Symbol">;</a> <a id="233" href="Data.Bool.Base.html#1053" class="Function Operator">_∨_</a> <a id="237" class="Symbol">to</a> <a id="240" class="Function Operator">_∨b_</a> <a id="245" class="Symbol">;</a> <a id="247" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="249" class="Symbol">to</a> <a id="252" class="Function">True</a><a id="256" class="Symbol">)</a>
<a id="258" class="Keyword">open</a> <a id="263" class="Keyword">import</a> <a id="270" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="285" class="Keyword">hiding</a> <a id="292" class="Symbol">(</a><a id="293" href="Data.Bool.Base.html#681" class="Datatype Operator">_≤_</a> <a id="297" class="Symbol">;</a> <a id="299" href="Data.Bool.Base.html#1505" class="Function Operator">if_then_else_</a> <a id="313" class="Symbol">)</a> <a id="315" class="Keyword">renaming</a> <a id="324" class="Symbol">(</a><a id="325" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a> <a id="329" class="Symbol">to</a> <a id="332" class="Function Operator">_∧b_</a> <a id="337" class="Symbol">;</a> <a id="339" href="Data.Bool.Base.html#1053" class="Function Operator">_∨_</a> <a id="343" class="Symbol">to</a> <a id="346" class="Function Operator">_∨b_</a> <a id="351" class="Symbol">;</a> <a id="353" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="355" class="Symbol">to</a> <a id="358" class="Function">True</a><a id="362" class="Symbol">)</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Data.Product.html" class="Module">Data.Product</a> <a id="389" class="Keyword">renaming</a> <a id="398" class="Symbol">(</a><a id="399" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="403" class="Symbol">to</a> <a id="406" class="InductiveConstructor Operator">_,,_</a> <a id="411" class="Symbol">)</a>
<a id="413" class="Keyword">open</a> <a id="418" class="Keyword">import</a> <a id="425" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="439" class="Keyword">hiding</a> <a id="446" class="Symbol">(</a><a id="447" href="Data.Nat.Base.html#1691" class="Datatype Operator">_≤_</a><a id="450" class="Symbol">)</a>
<a id="452" class="Keyword">open</a> <a id="457" class="Keyword">import</a> <a id="464" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="483" class="Keyword">hiding</a> <a id="490" class="Symbol">(</a><a id="491" href="Data.List.NonEmpty.Base.html#1291" class="Field">head</a><a id="495" class="Symbol">)</a>


<a id="499" class="Keyword">open</a> <a id="504" class="Keyword">import</a> <a id="511" href="libraries.natLib.html" class="Module">libraries.natLib</a>






<a id="Time"></a><a id="534" href="basicBitcoinDataType.html#534" class="Function">Time</a>   <a id="541" class="Symbol">:</a> <a id="543" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="547" href="basicBitcoinDataType.html#534" class="Function">Time</a>   <a id="554" class="Symbol">=</a>   <a id="558" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="Amount"></a><a id="560" href="basicBitcoinDataType.html#560" class="Function">Amount</a> <a id="567" class="Symbol">:</a> <a id="569" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="573" href="basicBitcoinDataType.html#560" class="Function">Amount</a> <a id="580" class="Symbol">=</a>  <a id="583" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="Address"></a><a id="586" href="basicBitcoinDataType.html#586" class="Function">Address</a> <a id="594" class="Symbol">:</a> <a id="596" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="600" href="basicBitcoinDataType.html#586" class="Function">Address</a>  <a id="609" class="Symbol">=</a>  <a id="612" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="TXID"></a><a id="615" href="basicBitcoinDataType.html#615" class="Function">TXID</a> <a id="620" class="Symbol">:</a> <a id="622" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="626" href="basicBitcoinDataType.html#615" class="Function">TXID</a> <a id="631" class="Symbol">=</a>    <a id="636" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="Signature"></a><a id="639" href="basicBitcoinDataType.html#639" class="Function">Signature</a> <a id="649" class="Symbol">:</a> <a id="651" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="655" href="basicBitcoinDataType.html#639" class="Function">Signature</a> <a id="665" class="Symbol">=</a>  <a id="668" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="PublicKey"></a><a id="671" href="basicBitcoinDataType.html#671" class="Function">PublicKey</a> <a id="681" class="Symbol">:</a> <a id="683" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="687" href="basicBitcoinDataType.html#671" class="Function">PublicKey</a>  <a id="698" class="Symbol">=</a>  <a id="701" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="704" class="Keyword">infixr</a> <a id="711" class="Number">3</a> <a id="713" href="basicBitcoinDataType.html#779" class="InductiveConstructor Operator">_+msg_</a>

<a id="721" class="Keyword">data</a> <a id="Msg"></a><a id="726" href="basicBitcoinDataType.html#726" class="Datatype">Msg</a> <a id="730" class="Symbol">:</a> <a id="732" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="736" class="Keyword">where</a>
   <a id="Msg.nat"></a><a id="745" href="basicBitcoinDataType.html#745" class="InductiveConstructor">nat</a>     <a id="753" class="Symbol">:</a>  <a id="756" class="Symbol">(</a><a id="757" href="basicBitcoinDataType.html#757" class="Bound">n</a> <a id="759" class="Symbol">:</a> <a id="761" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="762" class="Symbol">)</a>       <a id="770" class="Symbol">→</a> <a id="772" href="basicBitcoinDataType.html#726" class="Datatype">Msg</a>
   <a id="Msg._+msg_"></a><a id="779" href="basicBitcoinDataType.html#779" class="InductiveConstructor Operator">_+msg_</a>  <a id="787" class="Symbol">:</a>  <a id="790" class="Symbol">(</a><a id="791" href="basicBitcoinDataType.html#791" class="Bound">m</a> <a id="793" href="basicBitcoinDataType.html#793" class="Bound">m&#39;</a> <a id="796" class="Symbol">:</a> <a id="798" href="basicBitcoinDataType.html#726" class="Datatype">Msg</a><a id="801" class="Symbol">)</a>     <a id="807" class="Symbol">→</a> <a id="809" href="basicBitcoinDataType.html#726" class="Datatype">Msg</a>
   <a id="Msg.list"></a><a id="816" href="basicBitcoinDataType.html#816" class="InductiveConstructor">list</a>    <a id="824" class="Symbol">:</a>  <a id="827" class="Symbol">(</a><a id="828" href="basicBitcoinDataType.html#828" class="Bound">l</a>  <a id="831" class="Symbol">:</a> <a id="833" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="838" href="basicBitcoinDataType.html#726" class="Datatype">Msg</a><a id="841" class="Symbol">)</a>  <a id="844" class="Symbol">→</a> <a id="846" href="basicBitcoinDataType.html#726" class="Datatype">Msg</a>



<a id="853" class="Comment">-- function that compares time</a>
<a id="instructOpTime"></a><a id="884" href="basicBitcoinDataType.html#884" class="Function">instructOpTime</a> <a id="899" class="Symbol">:</a> <a id="901" class="Symbol">(</a><a id="902" href="basicBitcoinDataType.html#902" class="Bound">currentTime</a> <a id="914" class="Symbol">:</a> <a id="916" href="basicBitcoinDataType.html#534" class="Function">Time</a><a id="920" class="Symbol">)</a> <a id="922" class="Symbol">(</a><a id="923" href="basicBitcoinDataType.html#923" class="Bound">entryInContract</a> <a id="939" class="Symbol">:</a> <a id="941" href="basicBitcoinDataType.html#534" class="Function">Time</a><a id="945" class="Symbol">)</a> <a id="947" class="Symbol">→</a> <a id="949" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="954" href="basicBitcoinDataType.html#884" class="Function">instructOpTime</a> <a id="969" href="basicBitcoinDataType.html#969" class="Bound">currentTime</a> <a id="981" href="basicBitcoinDataType.html#981" class="Bound">entryInContract</a>  <a id="998" class="Symbol">=</a> <a id="1000" href="basicBitcoinDataType.html#981" class="Bound">entryInContract</a> <a id="1016" href="libraries.natLib.html#578" class="Function Operator">≤b</a> <a id="1019" href="basicBitcoinDataType.html#969" class="Bound">currentTime</a>



<a id="1034" class="Keyword">record</a> <a id="GlobalParameters"></a><a id="1041" href="basicBitcoinDataType.html#1041" class="Record">GlobalParameters</a> <a id="1058" class="Symbol">:</a> <a id="1060" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1064" class="Keyword">where</a>
  <a id="1072" class="Keyword">field</a>
    <a id="GlobalParameters.publicKey2Address"></a><a id="1082" href="basicBitcoinDataType.html#1082" class="Field">publicKey2Address</a> <a id="1100" class="Symbol">:</a> <a id="1102" class="Symbol">(</a><a id="1103" href="basicBitcoinDataType.html#1103" class="Bound">pubk</a> <a id="1108" class="Symbol">:</a> <a id="1110" href="basicBitcoinDataType.html#671" class="Function">PublicKey</a><a id="1119" class="Symbol">)</a> <a id="1121" class="Symbol">→</a> <a id="1123" href="basicBitcoinDataType.html#586" class="Function">Address</a>
    <a id="GlobalParameters.hash"></a><a id="1135" href="basicBitcoinDataType.html#1135" class="Field">hash</a>              <a id="1153" class="Symbol">:</a> <a id="1155" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1157" class="Symbol">→</a> <a id="1159" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
    <a id="GlobalParameters.signed"></a><a id="1165" href="basicBitcoinDataType.html#1165" class="Field">signed</a>            <a id="1183" class="Symbol">:</a> <a id="1185" class="Symbol">(</a><a id="1186" href="basicBitcoinDataType.html#1186" class="Bound">msg</a> <a id="1190" class="Symbol">:</a> <a id="1192" href="basicBitcoinDataType.html#726" class="Datatype">Msg</a><a id="1195" class="Symbol">)(</a><a id="1197" href="basicBitcoinDataType.html#1197" class="Bound">s</a> <a id="1199" class="Symbol">:</a> <a id="1201" href="basicBitcoinDataType.html#639" class="Function">Signature</a><a id="1210" class="Symbol">)(</a><a id="1212" href="basicBitcoinDataType.html#1212" class="Bound">publicKey</a> <a id="1222" class="Symbol">:</a> <a id="1224" href="basicBitcoinDataType.html#671" class="Function">PublicKey</a><a id="1233" class="Symbol">)</a> <a id="1235" class="Symbol">→</a> <a id="1237" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="GlobalParameters.Signed"></a><a id="1244" href="basicBitcoinDataType.html#1244" class="Function">Signed</a> <a id="1251" class="Symbol">:</a> <a id="1253" class="Symbol">(</a><a id="1254" href="basicBitcoinDataType.html#1254" class="Bound">msg</a> <a id="1258" class="Symbol">:</a> <a id="1260" href="basicBitcoinDataType.html#726" class="Datatype">Msg</a><a id="1263" class="Symbol">)(</a><a id="1265" href="basicBitcoinDataType.html#1265" class="Bound">s</a> <a id="1267" class="Symbol">:</a> <a id="1269" href="basicBitcoinDataType.html#639" class="Function">Signature</a><a id="1278" class="Symbol">)(</a><a id="1280" href="basicBitcoinDataType.html#1280" class="Bound">publicKey</a> <a id="1290" class="Symbol">:</a> <a id="1292" href="basicBitcoinDataType.html#671" class="Function">PublicKey</a><a id="1301" class="Symbol">)</a> <a id="1303" class="Symbol">→</a> <a id="1305" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="1311" href="basicBitcoinDataType.html#1244" class="Function">Signed</a> <a id="1318" href="basicBitcoinDataType.html#1318" class="Bound">msg</a> <a id="1322" href="basicBitcoinDataType.html#1322" class="Bound">s</a> <a id="1324" href="basicBitcoinDataType.html#1324" class="Bound">publicKey</a>  <a id="1335" class="Symbol">=</a> <a id="1337" href="basicBitcoinDataType.html#252" class="Function">True</a> <a id="1342" class="Symbol">(</a><a id="1343" href="basicBitcoinDataType.html#1165" class="Field">signed</a> <a id="1350" href="basicBitcoinDataType.html#1318" class="Bound">msg</a> <a id="1354" href="basicBitcoinDataType.html#1322" class="Bound">s</a> <a id="1356" href="basicBitcoinDataType.html#1324" class="Bound">publicKey</a><a id="1365" class="Symbol">)</a>

<a id="1368" class="Keyword">open</a> <a id="1373" href="basicBitcoinDataType.html#1041" class="Module">GlobalParameters</a> <a id="1390" class="Keyword">public</a>
</pre></body></html>