<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>stack</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="stack.html" class="Module">stack</a> <a id="14" class="Keyword">where</a>

<a id="21" class="Keyword">open</a> <a id="26" class="Keyword">import</a> <a id="33" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="43" class="Keyword">hiding</a> <a id="50" class="Symbol">(</a><a id="51" href="Data.Nat.Base.html#1691" class="Datatype Operator">_≤_</a><a id="54" class="Symbol">)</a>
<a id="56" class="Keyword">open</a> <a id="61" class="Keyword">import</a> <a id="68" href="Data.List.html" class="Module">Data.List</a> <a id="78" class="Keyword">hiding</a> <a id="85" class="Symbol">(</a><a id="86" href="Data.List.Base.html#1954" class="Function Operator">_++_</a><a id="90" class="Symbol">)</a>
<a id="92" class="Keyword">open</a> <a id="97" class="Keyword">import</a> <a id="104" href="Data.Unit.html" class="Module">Data.Unit</a>  
<a id="116" class="Keyword">open</a> <a id="121" class="Keyword">import</a> <a id="128" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="162" class="Keyword">open</a> <a id="167" class="Keyword">import</a> <a id="174" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="185" class="Keyword">hiding</a> <a id="192" class="Symbol">(</a><a id="193" href="Data.Bool.Base.html#681" class="Datatype Operator">_≤_</a> <a id="197" class="Symbol">;</a> <a id="199" href="Data.Bool.Base.html#1505" class="Function Operator">if_then_else_</a> <a id="213" class="Symbol">)</a> <a id="215" class="Keyword">renaming</a> <a id="224" class="Symbol">(</a><a id="225" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a> <a id="229" class="Symbol">to</a> <a id="232" class="Function Operator">_∧b_</a> <a id="237" class="Symbol">;</a> <a id="239" href="Data.Bool.Base.html#1053" class="Function Operator">_∨_</a> <a id="243" class="Symbol">to</a> <a id="246" class="Function Operator">_∨b_</a> <a id="251" class="Symbol">;</a> <a id="253" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="255" class="Symbol">to</a> <a id="258" class="Function">True</a><a id="262" class="Symbol">)</a>
<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="291" class="Keyword">hiding</a> <a id="298" class="Symbol">(</a><a id="299" href="Data.Bool.Base.html#681" class="Datatype Operator">_≤_</a> <a id="303" class="Symbol">;</a> <a id="305" href="Data.Bool.Base.html#1505" class="Function Operator">if_then_else_</a> <a id="319" class="Symbol">)</a> <a id="321" class="Keyword">renaming</a> <a id="330" class="Symbol">(</a><a id="331" href="Data.Bool.Base.html#995" class="Function Operator">_∧_</a> <a id="335" class="Symbol">to</a> <a id="338" class="Function Operator">_∧b_</a> <a id="343" class="Symbol">;</a> <a id="345" href="Data.Bool.Base.html#1053" class="Function Operator">_∨_</a> <a id="349" class="Symbol">to</a> <a id="352" class="Function Operator">_∨b_</a> <a id="357" class="Symbol">;</a> <a id="359" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="361" class="Symbol">to</a> <a id="364" class="Function">True</a><a id="368" class="Symbol">)</a>
<a id="370" class="Keyword">open</a> <a id="375" class="Keyword">import</a> <a id="382" href="Data.Product.html" class="Module">Data.Product</a> <a id="395" class="Keyword">renaming</a> <a id="404" class="Symbol">(</a><a id="405" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="409" class="Symbol">to</a> <a id="412" class="InductiveConstructor Operator">_,,_</a> <a id="417" class="Symbol">)</a>
<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="445" class="Keyword">hiding</a> <a id="452" class="Symbol">(</a><a id="453" href="Data.Nat.Base.html#1691" class="Datatype Operator">_≤_</a><a id="456" class="Symbol">)</a>
<a id="458" class="Keyword">open</a> <a id="463" class="Keyword">import</a> <a id="470" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="489" class="Keyword">hiding</a> <a id="496" class="Symbol">(</a><a id="497" href="Data.List.NonEmpty.Base.html#1291" class="Field">head</a><a id="501" class="Symbol">)</a>

<a id="504" class="Keyword">open</a> <a id="509" class="Keyword">import</a> <a id="516" href="libraries.listLib.html" class="Module">libraries.listLib</a>
<a id="534" class="Keyword">open</a> <a id="539" class="Keyword">import</a> <a id="546" href="libraries.natLib.html" class="Module">libraries.natLib</a>
<a id="563" class="Keyword">open</a> <a id="568" class="Keyword">import</a> <a id="575" href="libraries.boolLib.html" class="Module">libraries.boolLib</a>

<a id="594" class="Comment">--open import libraries.andLib</a>
<a id="625" class="Keyword">open</a> <a id="630" class="Keyword">import</a> <a id="637" href="libraries.maybeLib.html" class="Module">libraries.maybeLib</a>

<a id="657" class="Keyword">open</a> <a id="662" class="Keyword">import</a> <a id="669" href="basicBitcoinDataType.html" class="Module">basicBitcoinDataType</a>


<a id="Stack"></a><a id="692" href="stack.html#692" class="Function">Stack</a> <a id="698" class="Symbol">:</a> <a id="700" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="704" href="stack.html#692" class="Function">Stack</a> <a id="710" class="Symbol">=</a> <a id="712" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="717" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>


<a id="stackHasSingletonTop"></a><a id="721" href="stack.html#721" class="Function">stackHasSingletonTop</a>  <a id="743" class="Symbol">:</a> <a id="745" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="747" class="Symbol">→</a>   <a id="751" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="757" href="stack.html#692" class="Function">Stack</a> <a id="763" class="Symbol">→</a>  <a id="766" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="771" href="stack.html#721" class="Function">stackHasSingletonTop</a> <a id="792" href="stack.html#792" class="Bound">l</a> <a id="794" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="802" class="Symbol">=</a> <a id="804" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="810" href="stack.html#721" class="Function">stackHasSingletonTop</a> <a id="831" href="stack.html#831" class="Bound">l</a> <a id="833" class="Symbol">(</a><a id="834" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="839" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="841" class="Symbol">)</a> <a id="843" class="Symbol">=</a> <a id="845" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="851" href="stack.html#721" class="Function">stackHasSingletonTop</a> <a id="872" href="stack.html#872" class="Bound">l</a> <a id="874" class="Symbol">(</a><a id="875" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="880" class="Symbol">(</a><a id="881" href="stack.html#881" class="Bound">z</a> <a id="883" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="885" href="stack.html#885" class="Bound">y</a><a id="886" class="Symbol">))</a> <a id="889" class="Symbol">=</a>  <a id="892" href="stack.html#872" class="Bound">l</a>  <a id="895" href="libraries.natLib.html#723" class="Function Operator">==b</a> <a id="899" href="stack.html#881" class="Bound">z</a>


<a id="stackHasTop"></a><a id="903" href="stack.html#903" class="Function">stackHasTop</a>  <a id="916" class="Symbol">:</a>   <a id="920" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="925" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="927" class="Symbol">→</a>  <a id="930" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a>  <a id="937" href="stack.html#692" class="Function">Stack</a> <a id="943" class="Symbol">→</a> <a id="945" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="949" href="stack.html#903" class="Function">stackHasTop</a> <a id="961" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="964" href="stack.html#964" class="Bound">m</a> <a id="966" class="Symbol">=</a> <a id="968" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="970" href="stack.html#903" class="Function">stackHasTop</a> <a id="982" class="Symbol">(</a><a id="983" href="stack.html#983" class="Bound">y</a> <a id="985" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="987" href="stack.html#987" class="Bound">n</a><a id="988" class="Symbol">)</a> <a id="990" href="stack.html#990" class="Bound">m</a> <a id="992" class="Symbol">=</a> <a id="994" href="stack.html#258" class="Function">True</a><a id="998" class="Symbol">(</a><a id="999" href="stack.html#721" class="Function">stackHasSingletonTop</a> <a id="1020" href="stack.html#983" class="Bound">y</a> <a id="1022" href="stack.html#990" class="Bound">m</a><a id="1023" class="Symbol">)</a>

<a id="stackAuxFunction"></a><a id="1026" href="stack.html#1026" class="Function">stackAuxFunction</a> <a id="1043" class="Symbol">:</a>  <a id="1046" href="stack.html#692" class="Function">Stack</a> <a id="1052" class="Symbol">→</a> <a id="1054" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a> <a id="1059" class="Symbol">→</a> <a id="1061" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1067" href="stack.html#692" class="Function">Stack</a>
<a id="1073" href="stack.html#1026" class="Function">stackAuxFunction</a> <a id="1090" href="stack.html#1090" class="Bound">s</a> <a id="1092" href="stack.html#1092" class="Bound">b</a> <a id="1094" class="Symbol">=</a> <a id="1096" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1101" class="Symbol">(</a><a id="1102" href="libraries.natLib.html#877" class="Function">boolToNat</a> <a id="1112" href="stack.html#1092" class="Bound">b</a> <a id="1114" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1116" href="stack.html#1090" class="Bound">s</a><a id="1117" class="Symbol">)</a>


<a id="1121" class="Comment">-- Stack transformer</a>
<a id="StackTransformer"></a><a id="1142" href="stack.html#1142" class="Function">StackTransformer</a> <a id="1159" class="Symbol">:</a> <a id="1161" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1165" href="stack.html#1142" class="Function">StackTransformer</a> <a id="1182" class="Symbol">=</a> <a id="1184" href="basicBitcoinDataType.html#534" class="Function">Time</a> <a id="1189" class="Symbol">→</a> <a id="1191" href="basicBitcoinDataType.html#726" class="Datatype">Msg</a> <a id="1195" class="Symbol">→</a> <a id="1197" href="stack.html#692" class="Function">Stack</a> <a id="1203" class="Symbol">→</a> <a id="1205" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1211" href="stack.html#692" class="Function">Stack</a>

<a id="1218" class="Comment">-- function that checking if the stack is empty or the top element is false</a>
<a id="checkStackAux"></a><a id="1294" href="stack.html#1294" class="Function">checkStackAux</a> <a id="1308" class="Symbol">:</a> <a id="1310" href="stack.html#692" class="Function">Stack</a> <a id="1316" class="Symbol">→</a> <a id="1318" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1323" href="stack.html#1294" class="Function">checkStackAux</a> <a id="1337" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>  <a id="1341" class="Symbol">=</a> <a id="1343" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="1349" href="stack.html#1294" class="Function">checkStackAux</a> <a id="1363" class="Symbol">(</a><a id="1364" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="1369" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1371" href="stack.html#1371" class="Bound">bitcoinStack₁</a><a id="1384" class="Symbol">)</a>  <a id="1387" class="Symbol">=</a> <a id="1389" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="1395" href="stack.html#1294" class="Function">checkStackAux</a> <a id="1409" class="Symbol">(</a><a id="1410" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1414" href="stack.html#1414" class="Bound">x</a> <a id="1416" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1418" href="stack.html#1418" class="Bound">bitcoinStack₁</a><a id="1431" class="Symbol">)</a>  <a id="1434" class="Symbol">=</a> <a id="1436" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>

<a id="1442" class="Comment">-- lifting the checkStackAux to Maybe StackIfStack data type</a>
<a id="checkStack"></a><a id="1503" href="stack.html#1503" class="Function">checkStack</a> <a id="1514" class="Symbol">:</a>  <a id="1517" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1523" href="stack.html#692" class="Function">Stack</a>   <a id="1531" class="Symbol">→</a> <a id="1533" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1538" href="stack.html#1503" class="Function">checkStack</a> <a id="1549" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1557" class="Symbol">=</a> <a id="1559" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="1565" href="stack.html#1503" class="Function">checkStack</a> <a id="1576" class="Symbol">(</a><a id="1577" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1582" href="stack.html#1582" class="Bound">x</a><a id="1583" class="Symbol">)</a> <a id="1585" class="Symbol">=</a> <a id="1587" href="stack.html#1294" class="Function">checkStackAux</a> <a id="1601" href="stack.html#1582" class="Bound">x</a>
</pre></body></html>