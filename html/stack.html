<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>stack</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="stack.html" class="Module">stack</a> <a id="14" class="Keyword">where</a>

<a id="21" class="Keyword">open</a> <a id="26" class="Keyword">import</a> <a id="33" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="43" class="Keyword">hiding</a> <a id="50" class="Symbol">(</a><a id="51" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="54" class="Symbol">)</a>
<a id="56" class="Keyword">open</a> <a id="61" class="Keyword">import</a> <a id="68" href="Data.List.html" class="Module">Data.List</a> <a id="78" class="Keyword">hiding</a> <a id="85" class="Symbol">(</a><a id="86" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="90" class="Symbol">)</a>
<a id="92" class="Keyword">open</a> <a id="97" class="Keyword">import</a> <a id="104" href="Data.Unit.html" class="Module">Data.Unit</a>  <a id="115" class="Keyword">hiding</a> <a id="122" class="Symbol">(</a><a id="123" href="Data.Unit.Base.html#1023" class="Record Operator">_≤_</a><a id="126" class="Symbol">)</a>
<a id="128" class="Keyword">open</a> <a id="133" class="Keyword">import</a> <a id="140" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Data.Bool.html" class="Module">Data.Bool</a>  <a id="197" class="Keyword">hiding</a> <a id="204" class="Symbol">(</a><a id="205" href="Data.Bool.Base.html#672" class="Datatype Operator">_≤_</a> <a id="209" class="Symbol">;</a> <a id="211" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="225" class="Symbol">)</a> <a id="227" class="Keyword">renaming</a> <a id="236" class="Symbol">(</a><a id="237" href="Data.Bool.Base.html#986" class="Function Operator">_∧_</a> <a id="241" class="Symbol">to</a> <a id="244" class="Function Operator">_∧b_</a> <a id="249" class="Symbol">;</a> <a id="251" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a> <a id="255" class="Symbol">to</a> <a id="258" class="Function Operator">_∨b_</a> <a id="263" class="Symbol">;</a> <a id="265" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="267" class="Symbol">to</a> <a id="270" class="Function">True</a><a id="274" class="Symbol">)</a>
<a id="276" class="Keyword">open</a> <a id="281" class="Keyword">import</a> <a id="288" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="303" class="Keyword">hiding</a> <a id="310" class="Symbol">(</a><a id="311" href="Data.Bool.Base.html#672" class="Datatype Operator">_≤_</a> <a id="315" class="Symbol">;</a> <a id="317" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="331" class="Symbol">)</a> <a id="333" class="Keyword">renaming</a> <a id="342" class="Symbol">(</a><a id="343" href="Data.Bool.Base.html#986" class="Function Operator">_∧_</a> <a id="347" class="Symbol">to</a> <a id="350" class="Function Operator">_∧b_</a> <a id="355" class="Symbol">;</a> <a id="357" href="Data.Bool.Base.html#1044" class="Function Operator">_∨_</a> <a id="361" class="Symbol">to</a> <a id="364" class="Function Operator">_∨b_</a> <a id="369" class="Symbol">;</a> <a id="371" href="Data.Bool.Base.html#1451" class="Function">T</a> <a id="373" class="Symbol">to</a> <a id="376" class="Function">True</a><a id="380" class="Symbol">)</a>
<a id="382" class="Keyword">open</a> <a id="387" class="Keyword">import</a> <a id="394" href="Data.Product.html" class="Module">Data.Product</a> <a id="407" class="Keyword">renaming</a> <a id="416" class="Symbol">(</a><a id="417" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="421" class="Symbol">to</a> <a id="424" class="InductiveConstructor Operator">_,,_</a> <a id="429" class="Symbol">)</a>
<a id="431" class="Keyword">open</a> <a id="436" class="Keyword">import</a> <a id="443" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="457" class="Keyword">hiding</a> <a id="464" class="Symbol">(</a><a id="465" href="Data.Nat.Base.html#1535" class="Datatype Operator">_≤_</a><a id="468" class="Symbol">)</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="501" class="Keyword">hiding</a> <a id="508" class="Symbol">(</a><a id="509" href="Data.List.NonEmpty.Base.html#1141" class="Field">head</a><a id="513" class="Symbol">)</a>

<a id="516" class="Keyword">open</a> <a id="521" class="Keyword">import</a> <a id="528" href="libraries.listLib.html" class="Module">libraries.listLib</a>
<a id="546" class="Keyword">open</a> <a id="551" class="Keyword">import</a> <a id="558" href="libraries.natLib.html" class="Module">libraries.natLib</a>
<a id="575" class="Keyword">open</a> <a id="580" class="Keyword">import</a> <a id="587" href="libraries.boolLib.html" class="Module">libraries.boolLib</a>

<a id="606" class="Comment">--open import libraries.andLib</a>
<a id="637" class="Keyword">open</a> <a id="642" class="Keyword">import</a> <a id="649" href="libraries.maybeLib.html" class="Module">libraries.maybeLib</a>

<a id="669" class="Keyword">open</a> <a id="674" class="Keyword">import</a> <a id="681" href="basicBitcoinDataType.html" class="Module">basicBitcoinDataType</a>


<a id="Stack"></a><a id="704" href="stack.html#704" class="Function">Stack</a> <a id="710" class="Symbol">:</a> <a id="712" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="716" href="stack.html#704" class="Function">Stack</a> <a id="722" class="Symbol">=</a> <a id="724" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="729" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>


<a id="stackHasSingletonTop"></a><a id="733" href="stack.html#733" class="Function">stackHasSingletonTop</a>  <a id="755" class="Symbol">:</a> <a id="757" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="759" class="Symbol">→</a>   <a id="763" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="769" href="stack.html#704" class="Function">Stack</a> <a id="775" class="Symbol">→</a>  <a id="778" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="783" href="stack.html#733" class="Function">stackHasSingletonTop</a> <a id="804" href="stack.html#804" class="Bound">l</a> <a id="806" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="814" class="Symbol">=</a> <a id="816" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="822" href="stack.html#733" class="Function">stackHasSingletonTop</a> <a id="843" href="stack.html#843" class="Bound">l</a> <a id="845" class="Symbol">(</a><a id="846" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="851" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="853" class="Symbol">)</a> <a id="855" class="Symbol">=</a> <a id="857" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="863" href="stack.html#733" class="Function">stackHasSingletonTop</a> <a id="884" href="stack.html#884" class="Bound">l</a> <a id="886" class="Symbol">(</a><a id="887" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="892" class="Symbol">(</a><a id="893" href="stack.html#893" class="Bound">z</a> <a id="895" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="897" href="stack.html#897" class="Bound">y</a><a id="898" class="Symbol">))</a> <a id="901" class="Symbol">=</a>  <a id="904" href="stack.html#884" class="Bound">l</a>  <a id="907" href="libraries.natLib.html#736" class="Function Operator">==b</a> <a id="911" href="stack.html#893" class="Bound">z</a>


<a id="stackHasTop"></a><a id="915" href="stack.html#915" class="Function">stackHasTop</a>  <a id="928" class="Symbol">:</a>   <a id="932" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="937" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="939" class="Symbol">→</a>  <a id="942" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a>  <a id="949" href="stack.html#704" class="Function">Stack</a> <a id="955" class="Symbol">→</a> <a id="957" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="961" href="stack.html#915" class="Function">stackHasTop</a> <a id="973" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="976" href="stack.html#976" class="Bound">m</a> <a id="978" class="Symbol">=</a> <a id="980" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="982" href="stack.html#915" class="Function">stackHasTop</a> <a id="994" class="Symbol">(</a><a id="995" href="stack.html#995" class="Bound">y</a> <a id="997" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="999" href="stack.html#999" class="Bound">n</a><a id="1000" class="Symbol">)</a> <a id="1002" href="stack.html#1002" class="Bound">m</a> <a id="1004" class="Symbol">=</a> <a id="1006" href="stack.html#270" class="Function">True</a><a id="1010" class="Symbol">(</a><a id="1011" href="stack.html#733" class="Function">stackHasSingletonTop</a> <a id="1032" href="stack.html#995" class="Bound">y</a> <a id="1034" href="stack.html#1002" class="Bound">m</a><a id="1035" class="Symbol">)</a>

<a id="stackAuxFunction"></a><a id="1038" href="stack.html#1038" class="Function">stackAuxFunction</a> <a id="1055" class="Symbol">:</a>  <a id="1058" href="stack.html#704" class="Function">Stack</a> <a id="1064" class="Symbol">→</a> <a id="1066" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a> <a id="1071" class="Symbol">→</a> <a id="1073" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1079" href="stack.html#704" class="Function">Stack</a>
<a id="1085" href="stack.html#1038" class="Function">stackAuxFunction</a> <a id="1102" href="stack.html#1102" class="Bound">s</a> <a id="1104" href="stack.html#1104" class="Bound">b</a> <a id="1106" class="Symbol">=</a> <a id="1108" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1113" class="Symbol">(</a><a id="1114" href="libraries.natLib.html#890" class="Function">boolToNat</a> <a id="1124" href="stack.html#1104" class="Bound">b</a> <a id="1126" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1128" href="stack.html#1102" class="Bound">s</a><a id="1129" class="Symbol">)</a>


<a id="1133" class="Comment">-- Stack transformer</a>
<a id="StackTransformer"></a><a id="1154" href="stack.html#1154" class="Function">StackTransformer</a> <a id="1171" class="Symbol">:</a> <a id="1173" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1177" href="stack.html#1154" class="Function">StackTransformer</a> <a id="1194" class="Symbol">=</a> <a id="1196" href="basicBitcoinDataType.html#546" class="Function">Time</a> <a id="1201" class="Symbol">→</a> <a id="1203" href="basicBitcoinDataType.html#738" class="Datatype">Msg</a> <a id="1207" class="Symbol">→</a> <a id="1209" href="stack.html#704" class="Function">Stack</a> <a id="1215" class="Symbol">→</a> <a id="1217" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1223" href="stack.html#704" class="Function">Stack</a>

<a id="1230" class="Comment">-- function that checking if the stack is empty or the top element is false</a>
<a id="checkStackAux"></a><a id="1306" href="stack.html#1306" class="Function">checkStackAux</a> <a id="1320" class="Symbol">:</a> <a id="1322" href="stack.html#704" class="Function">Stack</a> <a id="1328" class="Symbol">→</a> <a id="1330" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1335" href="stack.html#1306" class="Function">checkStackAux</a> <a id="1349" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>  <a id="1353" class="Symbol">=</a> <a id="1355" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1361" href="stack.html#1306" class="Function">checkStackAux</a> <a id="1375" class="Symbol">(</a><a id="1376" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="1381" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1383" href="stack.html#1383" class="Bound">bitcoinStack₁</a><a id="1396" class="Symbol">)</a>  <a id="1399" class="Symbol">=</a> <a id="1401" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1407" href="stack.html#1306" class="Function">checkStackAux</a> <a id="1421" class="Symbol">(</a><a id="1422" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1426" href="stack.html#1426" class="Bound">x</a> <a id="1428" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1430" href="stack.html#1430" class="Bound">bitcoinStack₁</a><a id="1443" class="Symbol">)</a>  <a id="1446" class="Symbol">=</a> <a id="1448" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>

<a id="1454" class="Comment">-- lifting the checkStackAux to Maybe StackIfStack data type</a>
<a id="checkStack"></a><a id="1515" href="stack.html#1515" class="Function">checkStack</a> <a id="1526" class="Symbol">:</a>  <a id="1529" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1535" href="stack.html#704" class="Function">Stack</a>   <a id="1543" class="Symbol">→</a> <a id="1545" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1550" href="stack.html#1515" class="Function">checkStack</a> <a id="1561" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="1569" class="Symbol">=</a> <a id="1571" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="1577" href="stack.html#1515" class="Function">checkStack</a> <a id="1588" class="Symbol">(</a><a id="1589" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1594" href="stack.html#1594" class="Bound">x</a><a id="1595" class="Symbol">)</a> <a id="1597" class="Symbol">=</a> <a id="1599" href="stack.html#1306" class="Function">checkStackAux</a> <a id="1613" href="stack.html#1594" class="Bound">x</a>
</pre></body></html>